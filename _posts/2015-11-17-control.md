---
layout: default
title: 写控件中遇到的小问题
---

##{{ page.title }}

>####作者:admos_han 

>####日期:{{ page.date | date_to_string }}

>前几天常尝试了一下写自己的控件库，在这里简单定义一下组件和控件，控件更强调view层，组件则，说说我的疑惑和感受吧。总的感受就是一点：就是要去寻找控件化和定制化之间的平衡。我们使用控件，是出于这样一种目的，即：相同的代码不应该写第二遍。设计师给我们的UI稿中常常有很多相同的UI元素，如 看起来差不多的button，看起来差不多的选择框，往往我们只要修改很少的一点样式就可以了，这就没必要一次又一次的去写，一次次的写水平垂直居中，各种圆角等等，这是浪费生产力的体现。当然我们可以ctrl+c ctrl+v,但是首先这是不优雅的，程序员应该避免这样的做法，再者，这样做是新人不友好的，试想，如果一个freshman接手项目，那么对他来说，他无法得知去哪里复制代码，问题是，样式内容脚本的分离，不够规范的代码，也可能会让他困惑。而且一但项目大了之后，即便代码的作者本人也未必会记得全部。所以复制代码这种行为，应该避免的，也不能依赖的。

>当然，我们可以寻求于一些开源的组件库，如jquery ui等等，但是这些同样存在一些问题，第一个是学习成本，这个基本可以忽略不计，第二个是以bootstrap为例，如果我们使用bootstrap的样式，那么往往会造成风格的类似，也就是可定制化不高，人家一眼就能看出来，这是bootstrap做的。第三个，使用未知的第三方控件，甚至大的开源的控件，往往有可能有后门（前端的后门，比如，故意不过滤某些非法字符串，若后端未能识别或过滤就会形成xss攻击等）一旦被发现就会产生危险，当然使用那些开源的控件，可以不用考虑浏览器兼容等问题，自己做的也未必比人家的好（所以要多多加学习）。对于这些第三方控件的使用，最好是通读源码（了解其实现的细节，扬长避短），其次的是自己知道如何实现（出了bug方便修改，能根据需求去改动），不提倡在不通读源码或者不知道如何实现的情况下使用，当然，一切以业务为主，业务很紧迫，那也迫不得已。

>在我写控件的过程中，往往很矛盾，对于很简单的比如button这种控件，只有一个input标签，我们只要简单的包裹一下就可以形成控件（比如把原生的丑陋的边框换掉，比如增加圆角，我们可以接受一个对象，来控制button的高宽，圆角，颜色等等），而另一种很复杂的控件，比如，我们的设计图常常不使用原生的Select下拉框，而要求自己去实现一个，这个时候，这个控件比较复杂，可能包含很多div块，甚至还有文字，我们实现这个select的时候，我们希望将来的使用者去自定义哪些样式呢？select的边框，圆角，宽高，提示语，事件，下拉框的文字颜色，背景颜色，鼠标悬浮时候更改的背景颜色，我们看到，这有大量的可以定制的地方，可是，如果你都采取传参的情况的话，这个参数会很复杂，你不得不维护一份很长的文档来说明这个参数，这对使用者的学习成本都是非常高的。所以这就是矛盾之处，要自由，就麻烦，不麻烦，就没自由。

>首先这个问题肯定可以解决，因为react的例子在那里，当然，我还没有去研究过react，只是知道它专注view，组件化开发，虚拟dom等等，但是，我们知道这个问题肯定可以解决。针对这个问题，其实我有一个想法，那就是利用documentfragment来做，我动态的去构建我们想要的控件，使用者像以前一样写样式，我们提供默认样式，使用者可以使用自己的样式去覆盖默认样式。这个我觉得有一点可能去解决这个矛盾。等有空下来我就来实践。